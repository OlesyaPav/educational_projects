# Оценка риска ДТП по выбранному маршруту движения.

Учебный проект

Нужно создать систему, которая могла бы оценить риск ДТП по выбранному маршруту движения. Под риском понимается вероятность ДТП с любым повреждением транспортного средства. Как только водитель забронировал автомобиль, сел за руль и выбрал маршрут, система должна оценить уровень риска. Если уровень риска высок, водитель увидит предупреждение и рекомендации по маршруту.

## Цель проекта:
Создать модель предсказания ДТП.

## Описание данных
Данные представаляют собой три таблицы связанные общим ключом: collisions, parties, vehicles. Две таблицы связаны дополнительным ключом. После предобработки и объединеняи получили данные из 34 тыс. строк и 11 столбцов, включая таргет.

## Использовала библиотеки:
- import pandas as pd
- import matplotlib.pyplot as plt
- import datetime
- import time
- import numpy as np
- import seaborn as sns
- import phik
- import torch
- import torch.nn as nn
- import torch.nn.functional as F
- import torch.optim as optim
- import torchmetrics
- import random
- import pickle
- import shap

## Общий вывод:
Набор данных согласно техзаданию составляет ту часть исторических данных, где тип виновника только машина (если не виновник, то может быть не машина); повреждения любые кроме царапин; данные за 2012 г.

Для подготовки модели предсказния ДТП были выбраны следующие признаки: перекресток/неперекресток, погода, состояние дороги, освещение, категория нарушения, дорожное состояние, состояние водителя, наличие телефона с громкой связью, тип КПП, возраст машины, расстояние до главной дороги.

Данные были предобработаны, удалены дубликаты, устранены многичесленные пропуски, в модель взяты только те признаки, пропуски в которых могли быть заполнены или устранены другим способом без вреда для модели. Проведено исследование. Удален один выброс. Исследована зависимость между признаками.

Обучена нейросеть из четерых слоев, в которой найдены лучшие параметры перебром скорости, параметра dropout, размера батчей. F1 на этой модели достигла 0.68. Модель неточная, но на 83% определяет всех виновных. Значит, модель не досточно качественная, требует существенной доработки. Модель лучше выявляет ошибки второго .

Самыми важными фактора аварий выявлена тип кузова, возраст автомобиля, перекресток/неперекресток, тип КПП.

Всё-таки спобность модели оценивать риск недостаточно высок. Поэтому создание адекватной системы оценки риска при выдаче автомобиля на текущий момент невозможен. Много факторов косвенно влияющих на риск ДТП и слишком мало непосредственно влияющих и воспроизводимых. Но останавливаться и заканчивать попытки не стоит. Возможно стоит также учитывать факторы: пол (женщины , возможно, аккуратнее водят автомоибиль), наличие детей в машине (водитель с детьми, возможно внимательнее относится к правилам на дороге), знание ПДД также бы помогло снизить вероятность ДТП (допустим, пароль к системе - это правильный ответ на вопрос по ПДД). Один из важных факторов - это уважение водителей к друг другу, для его измерения понадобится психолог.
