# Прогнозирование заказов такси

Учебный проект

Компания «Чётенькое такси» собрала исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час. 

## Цель проекта:
Построить модель для такого предсказания.

## Описание данных
Данные представаляют собой временной ряд, который после ресемплирования по часу представляют сосбой таблицу из двух столбцов: индекса в формате даты и суммы заказов за последнйи час.

## Использовала библиотеки:
import pandas as pd
import numpy as np
import time
import os
import matplotlib.pyplot as plt
import matplotlib.dates as mdates

## Общий вывод:
Цель проекта построить модель для предсказания такси в аэропортах на следующий час достигнута.

Данные о заказах такси загружены и ресемплированы по одному часу. Получилось 4416 строк, охватывающих март-август 2018 г. Разложение на сезонность и тренд выявили период сезонности сутки, и увеличение количества заказов из месяца в месяц. Ресемплирование по дням отразило сезонность по неделям и резкое увеличение заказов в августе.

Данные проанализированы на сезонность и тренд. В результате выявлено, что обычно больше всего такси заказывают в полночь, меньше всего в 5 утра. Наблюдается тренд на увеличение заказов к августу по сравнению с мартом. Это сезонность с периодом сутки. Также проанализирована сезонность по дням, выявлена сезонность с периодом неделя, где пики приходятся на середину недели и выходные. Выявлено значительное увеличение заказов в августе. Тренд очевидно связан с успешным развитием компании, увеличении клиентов, а также увеличением туристического сезона в августе.

RMSE  при попытке составить прогноз без обучения - 57,19.

Были созданы признаки: час, месяц, дата, день недели, 5 признаков отставания на период, кратный суткам, и скользящее среднее по размеру окна из 24 часов. 

Была выделена тестовая выборка размером 10% от всех данных. При обучении трех моделей: Ridge, RandomForest и CatBoost, лучшую метрику RMSE на тестовых данных показала модель CatBoostRegressor ('depth': 6, 'iterations': 500, 'l2_leaf_reg': 3, 'learning_rate': 0.05). Её метрика на тестовых данных 38,48.

На графике отражено сравнение факта и прогноза.
